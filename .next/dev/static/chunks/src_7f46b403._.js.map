{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/Rohit%20Workspace/Product-%20YI/supabase-saas/src/lib/supabase/client.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\r\n\r\nexport const supabase = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n);\r\n"],"names":[],"mappings":";;;;AAGE;AAHF;;AAEO,MAAM,WAAW,IAAA,iMAAY"}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["C:/Users/DELL/Desktop/Rohit Workspace/Product- YI/supabase-saas/src/app/manager/dashboard/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport Link from 'next/link';\r\nimport { useEffect, useState } from 'react';\r\nimport { supabase } from '@/lib/supabase/client';\r\n\r\ntype Company = {\r\n  id: number;\r\n  company_name: string;\r\n  created_at: string;\r\n  user: string;\r\n};\r\n\r\ntype Profile = {\r\n  user: string;\r\n  full_name: string | null;\r\n  role: string;\r\n};\r\n\r\nexport default function ManagerDashboard() {\r\n  const [companies, setCompanies] = useState<Company[]>([]);\r\n  const [profiles, setProfiles] = useState<Record<string, string>>({});\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, []);\r\n\r\n  const fetchData = async () => {\r\n    setLoading(true);\r\n\r\n    // 1️⃣ Fetch ONLY client profiles\r\n    const { data: profileData, error: profileError } =\r\n      await supabase\r\n        .from('profiles')\r\n        .select('user, full_name, role')\r\n        .eq('role', 'client');\r\n\r\n    if (profileError) {\r\n      console.error('Profile error:', profileError);\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    const clientUserIds = profileData.map((p) => p.user);\r\n\r\n    // 2️⃣ Fetch companies for those users\r\n    const { data: companyData, error: companyError } =\r\n      await supabase\r\n        .from('companies')\r\n        .select('id, company_name, created_at, user')\r\n        .in('user', clientUserIds)\r\n        .order('created_at', { ascending: false });\r\n\r\n    if (companyError) {\r\n      console.error('Company error:', companyError);\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    // 3️⃣ Map user → name\r\n    const nameMap: Record<string, string> = {};\r\n    profileData.forEach((p) => {\r\n      nameMap[p.user] = p.full_name ?? '—';\r\n    });\r\n\r\n    setProfiles(nameMap);\r\n    setCompanies(companyData || []);\r\n    setLoading(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-100\">\r\n      {/* Header */}\r\n      <header className=\"relative z-50 bg-black text-yellow-400 px-6 py-4 flex justify-between items-center\">\r\n        <h1 className=\"text-xl font-semibold\">Manager Portal</h1>\r\n\r\n        <Link href=\"/manager/clients/new\">\r\n          <button className=\"bg-yellow-400 text-black px-4 py-2 rounded-md text-sm font-medium hover:bg-yellow-300\">\r\n            + Add Client\r\n          </button>\r\n        </Link>\r\n      </header>\r\n\r\n      {/* Content */}\r\n      <main className=\"p-6 max-w-7xl mx-auto\">\r\n        <h2 className=\"text-lg font-semibold mb-4\">Client Companies</h2>\r\n\r\n        <div className=\"bg-white rounded-lg shadow border overflow-x-auto\">\r\n          <table className=\"w-full text-sm\">\r\n            <thead className=\"bg-gray-50 border-b\">\r\n              <tr>\r\n                <th className=\"px-4 py-3 text-left\">Company</th>\r\n                <th className=\"px-4 py-3 text-left\">Client Name</th>\r\n                <th className=\"px-4 py-3 text-left\">Created</th>\r\n                <th className=\"px-4 py-3 text-right\">Action</th>\r\n              </tr>\r\n            </thead>\r\n\r\n            <tbody>\r\n              {companies.map((company) => (\r\n                <tr key={company.id} className=\"border-t hover:bg-gray-50\">\r\n                  <td className=\"px-4 py-3 font-medium\">\r\n                    {company.company_name}\r\n                  </td>\r\n\r\n                  <td className=\"px-4 py-3 text-gray-700\">\r\n                    {profiles[company.user] || '—'}\r\n                  </td>\r\n\r\n                  <td className=\"px-4 py-3 text-gray-500\">\r\n                    {new Date(company.created_at).toLocaleDateString()}\r\n                  </td>\r\n\r\n                  <td className=\"px-4 py-3 text-right\">\r\n                    <Link\r\n                      href={`/manager/companies/${company.id}/edit`}\r\n                      className=\"text-sm font-medium text-yellow-600 hover:underline\"\r\n                    >\r\n                      Update Context\r\n                    </Link>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n\r\n              {!loading && companies.length === 0 && (\r\n                <tr>\r\n                  <td colSpan={4} className=\"px-4 py-6 text-center text-gray-500\">\r\n                    No client companies found\r\n                  </td>\r\n                </tr>\r\n              )}\r\n\r\n              {loading && (\r\n                <tr>\r\n                  <td colSpan={4} className=\"px-4 py-6 text-center text-gray-400\">\r\n                    Loading companies...\r\n                  </td>\r\n                </tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["Link","useEffect","useState","supabase","Company","id","company_name","created_at","user","Profile","full_name","role","ManagerDashboard","companies","setCompanies","profiles","setProfiles","Record","loading","setLoading","fetchData","data","profileData","error","profileError","from","select","eq","console","clientUserIds","map","p","companyData","companyError","in","order","ascending","nameMap","forEach","company","Date","toLocaleDateString","length"],"mappings":"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","ignoreList":[]}}]
}