{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/Rohit%20Workspace/Product-%20YI/supabase-saas/src/lib/supabase/admin.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\r\n\r\nexport const supabaseAdmin = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n);\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,gBAAgB,IAAA,gMAAY,gFAEvC,QAAQ,GAAG,CAAC,yBAAyB"}},
    {"offset": {"line": 57, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/Rohit%20Workspace/Product-%20YI/supabase-saas/src/app/api/manager/create-client/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { supabaseAdmin } from '@/lib/supabase/admin';\r\n\r\nexport async function POST(req: Request) {\r\n  try {\r\n    const body = await req.json();\r\n\r\n    const {\r\n      full_name,\r\n      email,\r\n      password,\r\n      company_name,\r\n      company_context,\r\n    } = body;\r\n\r\n    if (\r\n      !email ||\r\n      !password ||\r\n      !company_name ||\r\n      !company_context\r\n    ) {\r\n      return NextResponse.json(\r\n        { error: 'Missing required fields' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // 1️⃣ Create auth user\r\n    const { data: user, error: userError } =\r\n      await supabaseAdmin.auth.admin.createUser({\r\n        email,\r\n        password,\r\n        email_confirm: true,\r\n      });\r\n\r\n    if (userError || !user.user) {\r\n      return NextResponse.json(\r\n        { error: userError?.message || 'User creation failed' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const userId = user.user.id;\r\n\r\n    // 2️⃣ Insert profile (client role)\r\n    const { error: profileError } =\r\n      await supabaseAdmin.from('profiles').insert({\r\n        user: userId,\r\n        role: 'client',\r\n        full_name,\r\n      });\r\n\r\n    if (profileError) {\r\n      return NextResponse.json(\r\n        { error: profileError.message },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // 3️⃣ Insert company (NO industry)\r\n    const { error: companyError } =\r\n      await supabaseAdmin.from('companies').insert({\r\n        company_name,\r\n        company_context,\r\n        user: userId,\r\n      });\r\n\r\n    if (companyError) {\r\n      return NextResponse.json(\r\n        { error: companyError.message },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    return NextResponse.json({ success: true });\r\n  } catch (err: any) {\r\n    return NextResponse.json(\r\n      { error: err.message || 'Server error' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAE3B,MAAM,EACJ,SAAS,EACT,KAAK,EACL,QAAQ,EACR,YAAY,EACZ,eAAe,EAChB,GAAG;QAEJ,IACE,CAAC,SACD,CAAC,YACD,CAAC,gBACD,CAAC,iBACD;YACA,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA0B,GACnC;gBAAE,QAAQ;YAAI;QAElB;QAEA,uBAAuB;QACvB,MAAM,EAAE,MAAM,IAAI,EAAE,OAAO,SAAS,EAAE,GACpC,MAAM,kJAAa,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC;YACxC;YACA;YACA,eAAe;QACjB;QAEF,IAAI,aAAa,CAAC,KAAK,IAAI,EAAE;YAC3B,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO,WAAW,WAAW;YAAuB,GACtD;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,SAAS,KAAK,IAAI,CAAC,EAAE;QAE3B,mCAAmC;QACnC,MAAM,EAAE,OAAO,YAAY,EAAE,GAC3B,MAAM,kJAAa,CAAC,IAAI,CAAC,YAAY,MAAM,CAAC;YAC1C,MAAM;YACN,MAAM;YACN;QACF;QAEF,IAAI,cAAc;YAChB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO,aAAa,OAAO;YAAC,GAC9B;gBAAE,QAAQ;YAAI;QAElB;QAEA,mCAAmC;QACnC,MAAM,EAAE,OAAO,YAAY,EAAE,GAC3B,MAAM,kJAAa,CAAC,IAAI,CAAC,aAAa,MAAM,CAAC;YAC3C;YACA;YACA,MAAM;QACR;QAEF,IAAI,cAAc;YAChB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO,aAAa,OAAO;YAAC,GAC9B;gBAAE,QAAQ;YAAI;QAElB;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,KAAU;QACjB,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO,IAAI,OAAO,IAAI;QAAe,GACvC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}