{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/Rohit%20Workspace/Product-%20YI/supabase-saas/src/lib/supabase/client.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\r\n\r\nexport const supabase = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n);\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,WAAW,IAAA,8LAAY"}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/Rohit%20Workspace/Product-%20YI/supabase-saas/src/app/manager/dashboard/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport Link from 'next/link';\r\nimport { useEffect, useState } from 'react';\r\nimport { supabase } from '@/lib/supabase/client';\r\n\r\ntype Company = {\r\n  id: number;\r\n  company_name: string;\r\n  created_at: string;\r\n  user: string;\r\n};\r\n\r\ntype Profile = {\r\n  user: string;\r\n  full_name: string | null;\r\n  role: string;\r\n};\r\n\r\nexport default function ManagerDashboard() {\r\n  const [companies, setCompanies] = useState<Company[]>([]);\r\n  const [profiles, setProfiles] = useState<Record<string, string>>({});\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, []);\r\n\r\n  const fetchData = async () => {\r\n    setLoading(true);\r\n\r\n    // 1️⃣ Fetch ONLY client profiles\r\n    const { data: profileData, error: profileError } =\r\n      await supabase\r\n        .from('profiles')\r\n        .select('user, full_name, role')\r\n        .eq('role', 'client');\r\n\r\n    if (profileError) {\r\n      console.error('Profile error:', profileError);\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    const clientUserIds = profileData.map((p) => p.user);\r\n\r\n    // 2️⃣ Fetch companies for those users\r\n    const { data: companyData, error: companyError } =\r\n      await supabase\r\n        .from('companies')\r\n        .select('id, company_name, created_at, user')\r\n        .in('user', clientUserIds)\r\n        .order('created_at', { ascending: false });\r\n\r\n    if (companyError) {\r\n      console.error('Company error:', companyError);\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    // 3️⃣ Map user → name\r\n    const nameMap: Record<string, string> = {};\r\n    profileData.forEach((p) => {\r\n      nameMap[p.user] = p.full_name ?? '—';\r\n    });\r\n\r\n    setProfiles(nameMap);\r\n    setCompanies(companyData || []);\r\n    setLoading(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-100\">\r\n      {/* Header */}\r\n      <header className=\"relative z-50 bg-black text-yellow-400 px-6 py-4 flex justify-between items-center\">\r\n        <h1 className=\"text-xl font-semibold\">Manager Portal</h1>\r\n\r\n        <Link href=\"/manager/clients/new\">\r\n          <button className=\"bg-yellow-400 text-black px-4 py-2 rounded-md text-sm font-medium hover:bg-yellow-300\">\r\n            + Add Client\r\n          </button>\r\n        </Link>\r\n      </header>\r\n\r\n      {/* Content */}\r\n      <main className=\"p-6 max-w-7xl mx-auto\">\r\n        <h2 className=\"text-lg font-semibold mb-4\">Client Companies</h2>\r\n\r\n        <div className=\"bg-white rounded-lg shadow border overflow-x-auto\">\r\n          <table className=\"w-full text-sm\">\r\n            <thead className=\"bg-gray-50 border-b\">\r\n              <tr>\r\n                <th className=\"px-4 py-3 text-left\">Company</th>\r\n                <th className=\"px-4 py-3 text-left\">Client Name</th>\r\n                <th className=\"px-4 py-3 text-left\">Created</th>\r\n                <th className=\"px-4 py-3 text-right\">Action</th>\r\n              </tr>\r\n            </thead>\r\n\r\n            <tbody>\r\n              {companies.map((company) => (\r\n                <tr key={company.id} className=\"border-t hover:bg-gray-50\">\r\n                  <td className=\"px-4 py-3 font-medium\">\r\n                    {company.company_name}\r\n                  </td>\r\n\r\n                  <td className=\"px-4 py-3 text-gray-700\">\r\n                    {profiles[company.user] || '—'}\r\n                  </td>\r\n\r\n                  <td className=\"px-4 py-3 text-gray-500\">\r\n                    {new Date(company.created_at).toLocaleDateString()}\r\n                  </td>\r\n\r\n                  <td className=\"px-4 py-3 text-right\">\r\n                    <Link\r\n                      href={`/manager/companies/${company.id}/edit`}\r\n                      className=\"text-sm font-medium text-yellow-600 hover:underline\"\r\n                    >\r\n                      Update Context\r\n                    </Link>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n\r\n              {!loading && companies.length === 0 && (\r\n                <tr>\r\n                  <td colSpan={4} className=\"px-4 py-6 text-center text-gray-500\">\r\n                    No client companies found\r\n                  </td>\r\n                </tr>\r\n              )}\r\n\r\n              {loading && (\r\n                <tr>\r\n                  <td colSpan={4} className=\"px-4 py-6 text-center text-gray-400\">\r\n                    Loading companies...\r\n                  </td>\r\n                </tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAmBe,SAAS;IACtB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAY,EAAE;IACxD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAyB,CAAC;IAClE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,IAAA,kNAAS,EAAC;QACR;IACF,GAAG,EAAE;IAEL,MAAM,YAAY;QAChB,WAAW;QAEX,iCAAiC;QACjC,MAAM,EAAE,MAAM,WAAW,EAAE,OAAO,YAAY,EAAE,GAC9C,MAAM,4IAAQ,CACX,IAAI,CAAC,YACL,MAAM,CAAC,yBACP,EAAE,CAAC,QAAQ;QAEhB,IAAI,cAAc;YAChB,QAAQ,KAAK,CAAC,kBAAkB;YAChC,WAAW;YACX;QACF;QAEA,MAAM,gBAAgB,YAAY,GAAG,CAAC,CAAC,IAAM,EAAE,IAAI;QAEnD,sCAAsC;QACtC,MAAM,EAAE,MAAM,WAAW,EAAE,OAAO,YAAY,EAAE,GAC9C,MAAM,4IAAQ,CACX,IAAI,CAAC,aACL,MAAM,CAAC,sCACP,EAAE,CAAC,QAAQ,eACX,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM;QAE5C,IAAI,cAAc;YAChB,QAAQ,KAAK,CAAC,kBAAkB;YAChC,WAAW;YACX;QACF;QAEA,sBAAsB;QACtB,MAAM,UAAkC,CAAC;QACzC,YAAY,OAAO,CAAC,CAAC;YACnB,OAAO,CAAC,EAAE,IAAI,CAAC,GAAG,EAAE,SAAS,IAAI;QACnC;QAEA,YAAY;QACZ,aAAa,eAAe,EAAE;QAC9B,WAAW;IACb;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BAEb,8OAAC;gBAAO,WAAU;;kCAChB,8OAAC;wBAAG,WAAU;kCAAwB;;;;;;kCAEtC,8OAAC,uKAAI;wBAAC,MAAK;kCACT,cAAA,8OAAC;4BAAO,WAAU;sCAAwF;;;;;;;;;;;;;;;;;0BAO9G,8OAAC;gBAAK,WAAU;;kCACd,8OAAC;wBAAG,WAAU;kCAA6B;;;;;;kCAE3C,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BAAM,WAAU;;8CACf,8OAAC;oCAAM,WAAU;8CACf,cAAA,8OAAC;;0DACC,8OAAC;gDAAG,WAAU;0DAAsB;;;;;;0DACpC,8OAAC;gDAAG,WAAU;0DAAsB;;;;;;0DACpC,8OAAC;gDAAG,WAAU;0DAAsB;;;;;;0DACpC,8OAAC;gDAAG,WAAU;0DAAuB;;;;;;;;;;;;;;;;;8CAIzC,8OAAC;;wCACE,UAAU,GAAG,CAAC,CAAC,wBACd,8OAAC;gDAAoB,WAAU;;kEAC7B,8OAAC;wDAAG,WAAU;kEACX,QAAQ,YAAY;;;;;;kEAGvB,8OAAC;wDAAG,WAAU;kEACX,QAAQ,CAAC,QAAQ,IAAI,CAAC,IAAI;;;;;;kEAG7B,8OAAC;wDAAG,WAAU;kEACX,IAAI,KAAK,QAAQ,UAAU,EAAE,kBAAkB;;;;;;kEAGlD,8OAAC;wDAAG,WAAU;kEACZ,cAAA,8OAAC,uKAAI;4DACH,MAAM,CAAC,mBAAmB,EAAE,QAAQ,EAAE,CAAC,KAAK,CAAC;4DAC7C,WAAU;sEACX;;;;;;;;;;;;+CAjBI,QAAQ,EAAE;;;;;wCAwBpB,CAAC,WAAW,UAAU,MAAM,KAAK,mBAChC,8OAAC;sDACC,cAAA,8OAAC;gDAAG,SAAS;gDAAG,WAAU;0DAAsC;;;;;;;;;;;wCAMnE,yBACC,8OAAC;sDACC,cAAA,8OAAC;gDAAG,SAAS;gDAAG,WAAU;0DAAsC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAWlF"}}]
}